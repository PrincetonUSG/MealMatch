<!DOCTYPE html>
<html>

<head>
	<title>MealMatch | View Upcoming Matches!</title>
	{% include 'imports.html' %}
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
		crossorigin="anonymous"></script>
</head>

<body>
	{% include 'header.html' %}


	<center>
		<div style="margin-top: 10px;">
			<h2 class="forceMaven">Your Matches</h2>
			<hr>
		</div>
	</center>
	{% for matches in all_matches %}
	<div class="container-fluid">

		<div class="card">
			<div class='row align-content-center'>
				<div class="card-body col-sm-9">
					<strong class="cardText"><b>{{matches[12]}}</b></strong><br>
					<strong class="cardText">
						{% if matches[10] %}
							{% if matches[6].isoweekday() == 6 or matches[6].isoweekday() == 7%}
								{% set meal= "Brunch" %}
							{%else%}
								{% set meal= "Lunch" %}
							{%endif%}
						{% else %}
						{% set meal= "Dinner" %}
						{%endif%}
						{{meal + ' @ ' + matches[4] + ' from ' +
						matches[5].strftime('%-I:%M%p') + " - " +
						matches[6].strftime('%-I:%M%p') }}
					</strong>
					<br>
					<strong class="cardText">{{matches[13]}}{{", " + matches[14]}}</strong><br>
					<strong class="cardText">Phone #: {{matches[15]}}</strong><br>
					<button class="cardText btn-sm btn-secondary" data-bs-toggle="modal"
						data-bs-target="#Modal_{{matches[0]}}"
						style="background-color: #bbb; border: 0px; margin-top: 5px;">View {{matches[12]}}'s Bio</a>
				</div>
				<div class="card-body col-sm-3 row">

					<center>
						<div>
							{% if matches[7] != "Both Accepted!" %}
							<strong id = "statusTooltip">Status: Match Pending
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16"
								data-toggle="tooltip" data-bs-placement="top" title="Check back later and look out for a text notification that your match has been made!">
									<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
									<path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
							  </svg>   
							</strong>
							{% else %}
							<strong id = "statusTooltip" style="color: #4b9e4b">Status: Match Made!
							<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-info-circle" viewBox="0 0 16 16"
								data-toggle="tooltip" data-bs-placement="top" title="Text your match to coordinate your meal!">
									<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
									<path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
							</svg>   
							</strong>
							</strong>
							{%endif%}
						</div>
						{% if matches[7] != '' %}
						<a id="matchStatus">{{matches[7]}}</a>
						{% else %}
						<form id="matchButton" method="POST"
							action="/acceptmatch?matchid={{matches[0]}}&phonenum={{matches[15]}}">
							<button class='btn-sm' style="background-color: #4b9e4b; color: white; border: 0cm">Accept
								Match
							</button>
						</form>
						{% endif %}
						<form id="matchButton" method="POST"
							action="/cancelmatch?matchid={{matches[0]}}&phonenum={{matches[15]}}">
							<button class='btn-sm' style="background-color: #c55353; color: white; border: 0cm">Cancel
								Match
							</button>
						</form>
					</center>
				</div>
			</div>
		</div>
		<div class="modal fade" id="Modal_{{matches[0]}}" tabindex="-1" aria-labelledby="ModalLabel_{{matches[0]}}"
			aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="ModalLabel_{{matches[0]}}">
							{{matches[12]}}'s Bio</h5>
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">
						<span>{{matches[16]}}</span><br>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary sml_button"
							data-bs-dismiss="modal">Close</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	{%endfor%}


</body>
<script>

   // $('#matchStatus').ready( function() {

   //    if($('#matchStatus').value === "Both Accepted!")
   //       $('#matchStatus').style = "color: #4b9e4b;"
   //    console.log('func triggered')

   // })

   $('#statusTooltip').ready(function () {
  	$('[data-toggle="tooltip"]').tooltip()
	})
</script>
<style>
	#matchButton {
		margin: 10px;
	}

	.card {
		margin-top: 20px;
	}

	.cardText {
		margin-left: 30px;
	}

	.sml_button {
		background-color: #ff9f46;
		color: white;
	}
</style>

</html>